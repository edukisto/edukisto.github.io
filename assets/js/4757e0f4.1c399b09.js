"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[756],{3905:(e,o,n)=>{n.d(o,{Zo:()=>p,kt:()=>m});var t=n(7294);function r(e,o,n){return o in e?Object.defineProperty(e,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[o]=n,e}function s(e,o){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);o&&(t=t.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),n.push.apply(n,t)}return n}function i(e){for(var o=1;o<arguments.length;o++){var n=null!=arguments[o]?arguments[o]:{};o%2?s(Object(n),!0).forEach((function(o){r(e,o,n[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}))}return e}function c(e,o){if(null==e)return{};var n,t,r=function(e,o){if(null==e)return{};var n,t,r={},s=Object.keys(e);for(t=0;t<s.length;t++)n=s[t],o.indexOf(n)>=0||(r[n]=e[n]);return r}(e,o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)n=s[t],o.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var a=t.createContext({}),l=function(e){var o=t.useContext(a),n=o;return e&&(n="function"==typeof e?e(o):i(i({},o),e)),n},p=function(e){var o=l(e.components);return t.createElement(a.Provider,{value:o},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var o=e.children;return t.createElement(t.Fragment,{},o)}},f=t.forwardRef((function(e,o){var n=e.components,r=e.mdxType,s=e.originalType,a=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),u=l(n),f=r,m=u["".concat(a,".").concat(f)]||u[f]||d[f]||s;return n?t.createElement(m,i(i({ref:o},p),{},{components:n})):t.createElement(m,i({ref:o},p))}));function m(e,o){var n=arguments,r=o&&o.mdxType;if("string"==typeof e||r){var s=n.length,i=new Array(s);i[0]=f;var c={};for(var a in o)hasOwnProperty.call(o,a)&&(c[a]=o[a]);c.originalType=e,c[u]="string"==typeof e?e:r,i[1]=c;for(var l=2;l<s;l++)i[l]=n[l];return t.createElement.apply(null,i)}return t.createElement.apply(null,n)}f.displayName="MDXCreateElement"},1373:(e,o,n)=>{n.r(o),n.d(o,{assets:()=>a,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>c,toc:()=>l});var t=n(7462),r=(n(7294),n(3905));const s={},i="Subresource spoofing",c={unversionedId:"infosec/02-resource-spoofing/source-code/resource-spoofing-over-dns-poisoning/README",id:"infosec/02-resource-spoofing/source-code/resource-spoofing-over-dns-poisoning/README",title:"Subresource spoofing",description:"Subresource spoofing \u0447\u0435\u0440\u0435\u0437 DNS poisoning/hijacking/redirection",source:"@site/docs/tlm/src/infosec/02-resource-spoofing/source-code/resource-spoofing-over-dns-poisoning/README.md",sourceDirName:"infosec/02-resource-spoofing/source-code/resource-spoofing-over-dns-poisoning",slug:"/infosec/02-resource-spoofing/source-code/resource-spoofing-over-dns-poisoning/",permalink:"/infosec/02-resource-spoofing/source-code/resource-spoofing-over-dns-poisoning/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"defaultSidebar",previous:{title:"\u041f\u0440\u0438\u043c\u0435\u0440 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u043d\u0438\u044f",permalink:"/infosec/02-resource-spoofing/example"},next:{title:"09.02.07\u2011\u0412\u0414. \u041c\u0414\u041a.09.01",permalink:"/laravel/"}},a={},l=[{value:"Subresource spoofing \u0447\u0435\u0440\u0435\u0437 DNS poisoning/hijacking/redirection",id:"subresource-spoofing-\u0447\u0435\u0440\u0435\u0437-dns-poisoninghijackingredirection",level:3},{value:"XAMPP",id:"xampp",level:3}],p={toc:l};function u(e){let{components:o,...n}=e;return(0,r.kt)("wrapper",(0,t.Z)({},p,n,{components:o,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"subresource-spoofing"},"Subresource spoofing"),(0,r.kt)("h3",{id:"subresource-spoofing-\u0447\u0435\u0440\u0435\u0437-dns-poisoninghijackingredirection"},"Subresource spoofing \u0447\u0435\u0440\u0435\u0437 DNS poisoning/hijacking/redirection"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"http://cdn.com/style.css"},"http://cdn.com/style.css")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"http://evil.com/style.css"},"http://evil.com/style.css")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"http://good.com/index.html"},"http://good.com/index.html")),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},"\u041a\u0442\u043e\xad\u2011\u0442\u043e \u0438\u043c\u0435\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a\xa0DNS \u0438\xa0\u043c\u0435\u043d\u044f\u0435\u0442 \u0437\u0430\u043f\u0438\u0441\u044c")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-txt"},"127.0.0.2 cdn.com\n")),(0,r.kt)("p",null,"\u043d\u0430"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-txt"},"127.0.0.3 cdn.com\n")),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},"\u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"ping cdn.com\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"#sudo a2dissite 000-default.conf\n\nsudo cp -R cdn.com/ /var/www/\nsudo cp -R evil.com/ /var/www/\nsudo cp -R good.com/ /var/www/\n\nsudo cp cdn.com.conf /etc/apache2/sites-available/\nsudo cp evil.com.conf /etc/apache2/sites-available/\nsudo cp good.com.conf /etc/apache2/sites-available/\n\nsudo a2ensite cdn.com.conf\nsudo a2ensite evil.com.conf\nsudo a2ensite good.com.conf\n\n\nsudo a2enmod headers\n\nsudo systemctl reload apache2\n")),(0,r.kt)("p",null,"By default, Ubuntu does not allow access through the web browser to any file outside of those located in /var/www, public_html directories (when enabled) and /usr/share (for web applications). If your site is using a web document root located elsewhere (such as in /srv) you may need to whitelist your document root directory in /etc/apache2/apache2.conf."),(0,r.kt)("h3",{id:"xampp"},"XAMPP"),(0,r.kt)("p",null,"\u0415\u0441\u043b\u0438 Forbidden, \u0442\u043e \u043e\u0448\u0438\u0431\u043a\u0430 \u0432 ",(0,r.kt)("inlineCode",{parentName:"p"},"DocumentRoot"),"."),(0,r.kt)("p",null,"\u0412 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435 Microsoft Edge Shift+F5 \u043d\u0435 \u0432\u0441\u0435\u0433\u0434\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442 \u043a\u0435\u0448, \u043d\u0443\u0436\u043d\u043e \u043f\u043e\u0434\u043e\u0436\u0434\u0430\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0434\u0435\u0441\u044f\u0442\u043a\u043e\u0432 \u0441\u0435\u043a\u0443\u043d\u0434."),(0,r.kt)("p",null,"\u041d\u0435 \u0437\u0430\u0431\u044b\u0432\u0430\u0439\u0442\u0435 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c Apache \u043f\u043e\u0441\u043b\u0435 \u043f\u0440\u0430\u0432\u043a\u0438 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438."),(0,r.kt)("p",null,"It is important to know that in order for SRI to work, the vendor host needs CORS enabled. To allow sharing responses cross-origin and allow for more versatile fetches than possible with HTML\u2019s form element, the CORS protocol exists. It is layered on top of HTTP and allows responses to declare they can be shared with other origins."),(0,r.kt)("p",null,"Cross-Origin Resource Sharing (\u0421\u043e\u0432\u043c\u0435\u0441\u0442\u043d\u043e\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u043c\u0435\u0436\u0434\u0443 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0430\u043c\u0438)."),(0,r.kt)("p",null,"\u0415\u0441\u043b\u0438 \u0431\u0440\u0430\u0443\u0437\u0435\u0440 \u0437\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0435\u0442 \u0442\u0435\u0433 \u0438\u0437 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u0442\u043b\u0438\u0447\u0430\u0435\u0442\u0441\u044f \u043e\u0442 \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u044f \u043f\u043e \u0441\u0445\u0435\u043c\u0435, \u0434\u043e\u043c\u0435\u043d\u043d\u043e\u043c\u0443 \u0438\u043c\u0435\u043d\u0438 \u0438\u043b\u0438 \u043f\u043e\u0440\u0442\u0443, \u0442\u043e \u044d\u0442\u043e cross-origin request (\u0437\u0430\u043f\u0440\u043e\u0441 \u0441 \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0430)."),(0,r.kt)("p",null,"CORS \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u0434\u0435\u043b\u044f\u0442\u0441\u044f \u043d\u0430 \u043f\u0440\u043e\u0441\u0442\u044b\u0435 \u0438 \u0441\u043b\u043e\u0436\u043d\u044b\u0435, \u0434\u043b\u044f \u043f\u0440\u043e\u0441\u0442\u044b\u0445 \u043d\u0435 \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u043f\u0435\u0440\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 OPTIONS, \u0437\u0430\u043f\u0440\u043e\u0441 \u0441\u0440\u0430\u0437\u0443 \u0443\u043b\u0435\u0442\u0430\u0435\u0442 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440 \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u044f \u0434\u0432\u0435\u0440\u0438 \u0434\u043b\u044f CSRF. \u041a \u043f\u0440\u043e\u0441\u0442\u044b\u043c \u0437\u0430\u043f\u0440\u043e\u0441\u0430\u043c \u043e\u0442\u043d\u043e\u0441\u044f\u0442\u0441\u044f: \u043c\u0435\u0442\u043e\u0434\u044b GET/POST/HEAD c content-type text/plain, application/x-www-form-urlencoded, multipart/form-data."),(0,r.kt)("hr",null),(0,r.kt)("p",null,"Access-Control-Allow-Origin: * \u0434\u043b\u044f \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u0441\u0430\u0439\u0442\u0430."),(0,r.kt)("p",null,"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 * \u0445\u043e\u0440\u043e\u0448\u043e \u043f\u043e\u0434\u043e\u0439\u0434\u0435\u0442 \u0432 \u0441\u043b\u0443\u0447\u0430\u044f\u0445, \u043a\u043e\u0433\u0434\u0430"),(0,r.kt)("p",null,"\u041d\u0435 \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u043d\u0438 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f, \u043d\u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f\n\u0420\u0435\u0441\u0443\u0440\u0441 \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u0448\u0438\u0440\u043e\u043a\u043e\u0439 \u0430\u0443\u0434\u0438\u0442\u043e\u0440\u0438\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0431\u0435\u0437 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0439\n\u0418\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u043e\u0432 \u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432, \u0443 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0431\u0443\u0434\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0440\u0435\u0441\u0443\u0440\u0441\u0430\u043c \u0432\u0435\u043b\u0438\u043a\u043e\u0435 \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u043e, \u0438 \u0432\u044b \u043d\u0435 \u0437\u043d\u0430\u0435\u0442\u0435 \u043e \u043d\u0438\u0445 \u0438\u043b\u0438 \u0432\u0430\u043c \u0432\u0441\u0435 \u0440\u0430\u0432\u043d\u043e, \u043a\u0442\u043e \u043e\u043d\u0438."),(0,r.kt)("hr",null),(0,r.kt)("p",null,"It is important to know that in order for SRI to work, the vendor host needs CORS enabled. Also it is good idea to monitor vendor JavaScript for changes in regular way. Because sometimes you can get secure but not working third-party code when the vendor decides to update it."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"openssl dgst -binary -sha384 \u0418\u041c\u042f_\u0424\u0410\u0419\u041b\u0410 | openssl base64 -A\n")))}u.isMDXComponent=!0}}]);